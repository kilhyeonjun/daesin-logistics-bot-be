# 물류 배차현황 카카오톡 챗봇

대신물류 배차현황 데이터를 크롤링하여 카카오톡 챗봇으로 조회할 수 있는 서비스입니다.

## 기능

- 배차현황 데이터 자동 크롤링 (매일 오전 6시, 오후 2시)
- SQLite DB에 데이터 저장 및 관리
- 카카오톡 챗봇으로 검색
  - 노선코드 검색
  - 차량번호 검색
  - 노선명(도착지) 검색
  - 일일 현황 조회

## 설치

```bash
npm install
```

## 실행

```bash
# 서버 시작
npm start

# 수동 동기화
npm run sync
```

## 카카오톡 챗봇 명령어

| 명령어 | 설명 | 예시 |
|--------|------|------|
| `노선 {코드}` | 노선코드로 검색 | 노선 101102 |
| `차량 {번호}` | 차량번호로 검색 | 차량 4536 |
| `도착 {지역}` | 노선명/도착지로 검색 | 도착 연희동 |
| `오늘 현황` | 오늘 전체 현황 | 오늘 현황 |
| `어제 현황` | 어제 전체 현황 | 어제 현황 |
| `도움말` | 사용법 보기 | 도움말 |

## API 엔드포인트

| 엔드포인트 | 메서드 | 설명 |
|------------|--------|------|
| `/health` | GET | 헬스체크 |
| `/api/sync` | POST | 수동 동기화 |
| `/api/routes/code/:code` | GET | 노선코드 검색 |
| `/api/routes/name/:name` | GET | 노선명 검색 |
| `/api/routes/car/:number` | GET | 차량번호 검색 |
| `/api/routes/date/:date` | GET | 날짜별 검색 |
| `/api/stats/:date` | GET | 날짜별 통계 |
| `/kakao/skill` | POST | 카카오톡 스킬 서버 |

## 카카오 비즈니스 채널 설정

1. [카카오 비즈니스](https://business.kakao.com) 가입
2. 채널 생성
3. [카카오 i 오픈빌더](https://i.kakao.com) 접속
4. 봇 생성 및 스킬 등록
   - 스킬 URL: `https://your-domain.com/kakao/skill`
5. 시나리오 블록에 스킬 연결

## 배포

ngrok 또는 클라우드 서버에 배포 후 카카오 스킬 URL 등록

```bash
# ngrok으로 로컬 테스트
ngrok http 3000
```
